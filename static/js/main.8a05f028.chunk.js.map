{"version":3,"sources":["assets/fonts/good_neighbors.png","util/layer.ts","util/LockableKeyListener.ts","game/PixelFont.tsx","game/GameStats.tsx","game/EnergySources/slice.ts","game/WorldItems/slice.ts","util/limitRenders.ts","game/energySources.ts","game/WorldItems/YoshiEgg.tsx","game/Inventory/slice.ts","game/Menu/slice.ts","store.ts","game/Character.tsx","game/Debug.tsx","game/EnergySource.tsx","game/TiledMap.tsx","game/Level.tsx","game/IntroWorld.tsx","game/Menu/index.tsx","game/Menu/BaseMenu.tsx","game/Menu/InventoryMenu.tsx","game/Menu/TestMenu.tsx","game/Menu/GameMenuHandler.tsx","game/Scalator.tsx","game/Viewport.tsx","game/Game.tsx","game/index.ts","index.tsx"],"names":["module","exports","COLLISION_GROUP","COLLISION_CATEGORY","LockableKeyListener","_KeyListener","_getPrototypeOf2","_this","Object","classCallCheck","this","_len","arguments","length","args","Array","_key","possibleConstructorReturn","getPrototypeOf","call","apply","concat","locks","KEY_I","KEY_P","ENTER","inherits","createClass","key","value","lock","Symbol","push","filter","l","get","prototype","KeyListener","charMap","require","PixelFont","_React$Component","props","canvas","React","canvasPainted","img","state","loaded","drawText","text","current","chars","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","iterator","next","done","c","String","fromCharCode","Error","charLeft","nextChar","charCodeAt","charRight","err","return","width","reduce","acc","_ref","_ref2","slicedToArray","ctx","getContext","pos","_i","_ref5","_ref4","r","drawImage","document","createElement","onload","setState","src","newProps","newState","react","ref","height","style","className","connect","playerStats","objectSpread","react_default","a","PixelFont_PixelFont","energy","toFixed","money","food","energySources","createSlice","slice","initialState","reducers","addEnergySource","_ref$payload","payload","id","data","objectWithoutProperties","toConsumableArray","UUID","v4","playerGainEnergyDelta","playerGainMoneyDelta","playerGainFoodDelta","createdAt","Date","worldItems","add","layerToRects","layer","tilewidth","tileheight","rectMap","Composite","create","getRect","x","y","setRect","rect","accumulateLayer","dy","dx","left","top","x1","row","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","includes","layers","subLayer","map","throttleExecution","fn","maxFps","lastExecution","now","performance","getFpsMeasure","callback","thisSecond","framesThisSecond","second","Math","floor","linkEnergySource","body","linkedEnergySources","getEnergySourceLink","getEnergySourceData","has","WeakMap","YoshiEgg","update","bodyRef","round","position","sqrt","pow","spawnId","radius","energyAmount","Number","POSITIVE_INFINITY","lossDelta","colorCode","createRef","Matter","Events","on","context","engine","off","_this$state","_this$props","getWrapperStyles","lib","shape","inertia","Infinity","collisionFilter","group","CAN_COLLIDE","category","OBJECT","mask","PLAYER","WALL","Component","contextTypes","PropTypes","object","actions","yoshiEgg","name","onUse","playerLocation","inventory","addItem","item","removeItem","_ref3","index","openMenus","open","closeTop","modifyEnergy","min","modifyMoney","max","modifyFood","setCharacterPosition","_ref4$payload","store","configureStore","reducer","combineReducers","middleware","devTools","enhancers","Character","move","Body","setVelocity","isMoving","fpsCounter","fps","console","log","checkKeys","spriteState","keys","walkSpeed","velocityX","velocityY","isDown","LEFT","RIGHT","UP","DOWN","modifyEnergyTimerId","_this2","window","setInterval","clearInterval","_this$props2","transform","_this$props3","ALL","getSpriteWrapperStyle","tileHeight","tileWidth","toString","repeat","scale","steps","_ref$playerLocation","Debug","debugEnabled","visibleLayers","debugRender","_this$props$tmxJs","tmxJs","Render","options","enabled","pixelRatio","background","wireframeBackground","wireframes","showSleeping","showDebug","showBroadphase","showBounds","showVelocity","showCollisions","showSeparations","showAxes","showPositions","showAngleIndicator","showIds","showShadows","showVertexNumbers","showConvexHulls","showInternalEdges","showMousePosition","run","EnergySource","linkTo","setPosition","world","Bodies","circle","isSensor","isStatic","NEVER_COLLIDES","SENSOR","World","addBody","set","isFinite","timeLeft","setTimeout","registerEnergySource","remove","in","stdDeviation","cx","cy","fill","TiledMap","tilemapLoaded","tilemapImage","canvasLayers","lastDrawnCanvasLayers","tileFileName","_drawCanvas","asyncToGenerator","regenerator_default","mark","_callee","tileSet","lastDrawnCanvas","wrap","_context","prev","abrupt","drawCanvasLayer","stop","_x","gridIndex","save","drawCanvasTile","restore","tileIndex","tileset","_this$props$tsxJs","tsxJs","cols","columns","spacing","flip_horiz","flip_vert","flip_diag","realTileIndex","tileX","tileY","posX","posY","translate","rotate","PI","_this3","_this$props$tmxJs2","drawCanvas","idx","image","Level","transformOrigin","TiledMap_TiledMap","tileData","IntroWorld","physicsInit","gravity","collision","tmx","composite","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","forEach","rectangle","extractTmxCollisionComposite","addComposite","_ref6","e","totalDeltaEnergy","totalDeltaMoney","totalDeltaFood","pairs","pair","energySourceData","bodyA","bodyB","distance","factor","_props$tileData$tmxJs","mapHeight","mapWidth","yoshiEggs","from","_","i","random","onInit","onUpdate","Level_Level","Debug_Debug","assign","keyListener","_ref7","EnergySource_EnergySource","game_Character","_ref8","MenuPane","styled","div","border","padding","MenuList","display","flexDirection","alignItems","alignContent","MenuItem","_templateObject","selected","BaseMenu","selectedOption","keyLock","loopSubscription","changeSelectedOption","SPACE","selectMenuOption","movement","onSelect","rows","acquireLock","loop","subscribe","unsubscribe","releaseLock","onClick","BaseMenu_templateObject","items","dispatch","Menu_BaseMenu","closeTopMenu","TestMenu","GameMenuHandler","openInventory","openMenu","menu","menus","commonProps","menuName","InventoryMenu","getMenuComponent","Scalator","getScaleStyles","children","number","childContextTypes","Viewport","resizeHandler","getDerivedStateFromProps","displayX","playerX","displayY","playerY","newLeft","newTop","addEventListener","removeEventListener","getStyles","makeDistortionCurve","amount","k","curve","Float32Array","deg","abs","Game","player","distortion","distortionLevel","stopMusic","isAlive","AudioPlayer","analyser","createAnalyser","createWaveShaper","source","createBufferSource","gainNode","createGain","gain","destination","buffer","start","bind","getStageStyles","Scalator_Scalator","game_Viewport","game_IntroWorld","getGameStatsWrapperStyles","game_GameStats","Menu_GameMenuHandler","fontSize","ReactDOM","render","es","game","getElementById"],"mappings":"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","file":"static/js/main.8a05f028.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,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\"","import { Bodies, Composite } from 'matter-js';\n\nexport interface Layer {\n    data?: number[];\n    height: number;\n    name: string;\n    opacity: number;\n    type: string;\n    visible: boolean;\n    width: number;\n    x: number;\n    y: number;\n    layers?: Array<Layer>;\n}\n\nexport interface Tileset {\n    firstgid: number;\n    source: string;\n}\n\nexport interface TmxJson {\n    height: number;\n    infinite: boolean;\n    layers: Layer[];\n    nextobjectid: number;\n    orientation: string;\n    renderorder: string;\n    tiledversion: string;\n    tileheight: number;\n    tilesets: Tileset[];\n    tilewidth: number;\n    type: string;\n    version: number;\n    width: number;\n}\n\nexport interface TsxJson {\n    columns: number;\n    image: string;\n    imageheight: number;\n    imagewidth: number;\n    margin: number;\n    name: string;\n    spacing: number;\n    tilecount: number;\n    tileheight: number;\n    tilewidth: number;\n    type: string;\n}\n\nexport type TileData = {\n    tmxJs: TmxJson;\n    tsxJs: TsxJson;\n};\n\ninterface Rect {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n}\n\nexport function layerToRects(layer: Layer, { tilewidth, tileheight }: TmxJson): Rect[] {\n    const composite = Composite.create();\n\n    const rectMap: Array<Array<Rect>> = [];\n    const getRect = (x: number, y: number): Rect | undefined => (rectMap[y] || [])[x];\n    const setRect = (x: number, y: number, rect: Rect) => {\n        if (!rectMap[y]) {\n            rectMap[y] = [];\n        }\n        rectMap[y][x] = rect;\n    };\n\n    const accumulateLayer = (layer: Layer) => {\n        if (layer.data) {\n            for (let dy = 0; dy < layer.height; dy++) {\n                for (let dx = 0; dx < layer.width; dx++) {\n                    const x = layer.x + dx;\n                    const y = layer.y + dy;\n                    const value = layer.data[dy * layer.width + dx];\n\n                    if (value) {\n                        let rect = { x, y, width: 1, height: 1 };\n                        const left = getRect(x - 1, y);\n                        if (left && left.height === 1) {\n                            // grow right\n                            left.width++;\n                            rect = left;\n                        }\n\n                        const top = getRect(x, y - 1);\n                        if (top && top.x == rect.x && top.width === rect.width) {\n                            // grow bottom\n                            for (let x1 = rect.x; x1 < rect.x + rect.width; x1++) {\n                                setRect(x1, y, top);\n                            }\n                            top.height++;\n                            rect = top;\n                        }\n\n                        setRect(x, y, rect);\n                    }\n                }\n            }\n        }\n\n        const acc: Rect[] = [];\n        for (const row of rectMap) {\n            if (!row) {\n                continue;\n            }\n            for (const rect of row) {\n                if (rect && !acc.includes(rect)) {\n                    acc.push(rect);\n                }\n            }\n        }\n\n        for (const subLayer of layer.layers || []) {\n            acc.push(...accumulateLayer(subLayer));\n        }\n\n        return acc;\n    };\n\n    return accumulateLayer(layer).map(({ x, y, width, height }) => ({\n        x: x * tilewidth,\n        y: y * tileheight,\n        width: width * tilewidth,\n        height: height * tileheight,\n    }));\n}\n\nexport enum COLLISION_GROUP {\n    CAN_COLLIDE = 0,\n    NEVER_COLLIDES = -1,\n}\n\nexport enum COLLISION_CATEGORY {\n    ALL = -1,\n    PLAYER = 1,\n    WALL = 2,\n    OBJECT = 4,\n    SENSOR = 8,\n}\n\nexport function extractTmxCollisionComposite(tmx: TmxJson): Composite {\n    const composite = Composite.create();\n    const options = {\n        isStatic: true,\n        collisionFilter: {\n            group: COLLISION_GROUP.NEVER_COLLIDES,\n            category: COLLISION_CATEGORY.WALL,\n            mask: COLLISION_CATEGORY.PLAYER | COLLISION_CATEGORY.OBJECT,\n        },\n    };\n\n    const buildRect = (x: number, y: number, width: number, height: number) =>\n        Bodies.rectangle(x + width / 2, y + height / 2, width, height, options);\n\n    for (const layer of tmx.layers) {\n        if (layer.name.includes('collision')) {\n            layerToRects(layer, tmx).forEach(rect =>\n                Composite.add(composite, buildRect(rect.x, rect.y, rect.width, rect.height))\n            );\n        }\n    }\n    return composite;\n}\n","import { KeyListener } from 'react-game-kit';\n\nexport type KeyLock = symbol;\n\nexport class LockableKeyListener extends KeyListener {\n    private locks: KeyLock[] = [];\n\n    public readonly KEY_I = 73;\n    public readonly KEY_P = 80;\n    public readonly ENTER = 13;\n\n    public acquireLock(): KeyLock {\n        const lock: KeyLock = Symbol();\n        this.locks.push(lock);\n        return lock;\n    }\n\n    public releaseLock(lock: KeyLock) {\n        this.locks = this.locks.filter(l => l !== lock);\n    }\n\n    public forceClearLock() {\n        this.locks = [];\n    }\n\n    public isDown(key: number, lock?: KeyLock) {\n        return (this.locks.length === 0 || this.locks[this.locks.length - 1] === lock) && super.isDown(key);\n    }\n}\n","import * as React from 'react';\n\ninterface Props {\n    text: string;\n    style?: React.CSSProperties;\n    className?: string;\n}\n\ninterface State {\n    loaded: boolean;\n}\nconst charMap = require('../assets/fonts/good_neighbors.json');\n\nexport class PixelFont extends React.Component<Props, State> {\n    private canvas = React.createRef<HTMLCanvasElement>();\n    private canvasPainted = false;\n    private img: HTMLImageElement;\n    public state = {\n        loaded: false,\n    };\n\n    public constructor(props: Props) {\n        super(props);\n        this.img = document.createElement('img');\n        this.img.onload = () => this.setState({ loaded: true });\n        this.img.src = require('../assets/fonts/good_neighbors.png');\n    }\n\n    private drawText = (text: string) => {\n        if (this.canvasPainted || !this.canvas.current || !this.state.loaded) {\n            return;\n        }\n\n        const chars: Array<[number, number, string, string]> = [];\n        for (let c of text) {\n            if (c === ' ') {\n                c = String.fromCharCode(127);\n            }\n            if (!charMap[c]) {\n                throw new Error(`unknown character '${c}'`);\n            }\n            const charLeft = charMap[c];\n            const nextChar = String.fromCharCode(c.charCodeAt(0) + 1);\n            const charRight = charMap[nextChar];\n            chars.push([charLeft, charRight, c, nextChar]);\n        }\n        const width = chars.reduce((acc, [l, r]) => acc + r - l, 0);\n\n        this.canvas.current.width = width;\n\n        const ctx = this.canvas.current.getContext('2d')!;\n        let pos = 0;\n        for (const [l, r] of chars) {\n            ctx.drawImage(this.img, l, 0, r - l, 16, pos, 0, r - l, 16);\n            pos += r - l;\n        }\n    };\n\n    public componentDidMount() {\n        if (this.canvas.current && !this.canvasPainted) {\n            this.drawText(this.props.text);\n        }\n    }\n\n    public componentWillReceiveProps(newProps: Props, newState: State) {\n        if (newProps.text !== this.props.text || this.state.loaded !== newState.loaded) {\n            this.drawText(newProps.text);\n        }\n    }\n\n    public render() {\n        return <canvas ref={this.canvas} height={16} style={this.props.style} className={this.props.className} />;\n    }\n}\n","import React, { FunctionComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport { State } from '../store';\nimport { PixelFont } from './PixelFont';\n\nconst GameStats: FunctionComponent<State['playerStats']> = props => (\n    <ul>\n        <li className=\"energy\">\n            <span className=\"label\">\n                <PixelFont text=\"Energie:\" />\n            </span>\n            <PixelFont text={props.energy.toFixed(1)} />\n        </li>\n        <li className=\"money\">\n            <span className=\"label\">\n                <PixelFont text=\"Geld:\" />\n            </span>\n            <PixelFont text={props.money.toFixed(1)} />\n        </li>\n        <li className=\"food\">\n            <span className=\"label\">\n                <PixelFont text=\"Essen:\" />\n            </span>\n            <PixelFont text={props.food.toFixed(1)} />\n        </li>\n    </ul>\n);\n\nexport default connect(({ playerStats }: State) => ({ ...playerStats }))(GameStats);\n","import { createSlice, PayloadAction } from 'redux-starter-kit';\nimport UUID from 'uuid';\n\nimport { Omit } from '@emotion/styled-base/types/helper';\n\nimport { EnergySourceData } from '../energySources';\n\ntype AllowedPartialBlar = 'id' | 'playerGainEnergyDelta' | 'playerGainMoneyDelta' | 'playerGainFoodDelta';\nexport type EnergySourceCreationData = Omit<EnergySourceData, 'createdAt' | AllowedPartialBlar> &\n    Partial<Pick<EnergySourceData, AllowedPartialBlar>>;\n\nexport const energySources = createSlice({\n    slice: 'energySources',\n    initialState: [] as Array<EnergySourceData>,\n    reducers: {\n        addEnergySource: (state, { payload: { id, ...data } }: PayloadAction<EnergySourceCreationData>) => [\n            ...state,\n            {\n                id: id || UUID.v4(),\n                playerGainEnergyDelta: () => 0,\n                playerGainMoneyDelta: () => 0,\n                playerGainFoodDelta: () => 0,\n                ...data,\n                createdAt: new Date(),\n            },\n        ],\n    },\n});\n","import { createSlice, PayloadAction, PayloadActionCreator } from 'redux-starter-kit';\n\nimport { WorldItem } from './types';\n\nexport const worldItems = createSlice({\n    slice: 'worldItems',\n    initialState: [] as Array<WorldItem>,\n    reducers: {\n        add: (state, { payload }: PayloadAction<WorldItem>) => [...state, payload],\n    },\n});\n","export const throttleExecution = <T extends (...args: any) => void>(fn: T, maxFps = 30): T => {\n    let lastExecution = 0;\n    return ((...args: any) => {\n        const now = performance.now();\n        if (now - lastExecution > 1000 / maxFps) {\n            lastExecution = now;\n            return fn(...args);\n        }\n    }) as T;\n};\n\nexport const getFpsMeasure = (callback: (fps: number) => void) => {\n    let thisSecond = 0;\n    let framesThisSecond = 0;\n    return () => {\n        const second = Math.floor(performance.now() / 1000);\n        if (thisSecond !== second) {\n            thisSecond = second;\n\n            callback(framesThisSecond);\n            framesThisSecond = 0;\n        }\n        framesThisSecond++;\n    };\n};\n","import Matter from 'matter-js';\n\nimport { COLLISION_CATEGORY, COLLISION_GROUP } from '../util/layer';\n\ntype PlayerGainHandler = ({ energy, money, food }: { energy: number; money: number; food: number }) => number;\n\nexport interface EnergySourceData {\n    id: string;\n    createdAt: Date;\n\n    x: number;\n    y: number;\n    radius: number;\n\n    energyAmount: number;\n    lossDelta: number;\n\n    colorCode: string | null;\n\n    playerGainEnergyDelta: PlayerGainHandler;\n    playerGainMoneyDelta: PlayerGainHandler;\n    playerGainFoodDelta: PlayerGainHandler;\n}\n\nexport const linkEnergySource = (key: string, body: Matter.Body) => {\n    linkedEnergySources[key] = body;\n};\n\nexport const getEnergySourceLink = (key: string): Matter.Body | undefined => {\n    return linkedEnergySources[key];\n};\n\nexport const registerEnergySource = (world: Matter.World, data: EnergySourceData): Matter.Body => {\n    const body = Matter.Bodies.circle(data.x, data.y, data.radius, {\n        isSensor: true,\n        isStatic: false,\n        collisionFilter: {\n            group: COLLISION_GROUP.NEVER_COLLIDES,\n            category: COLLISION_CATEGORY.SENSOR,\n            mask: COLLISION_CATEGORY.PLAYER,\n        },\n    });\n\n    Matter.World.addBody(world, body);\n\n    energySources.set(body, data);\n\n    if (Number.isFinite(data.energyAmount) && data.lossDelta !== 0) {\n        const timeLeft = (data.energyAmount / data.lossDelta) * 1000;\n        setTimeout(() => {\n            console.log('better clear that fluff');\n            // Matter.World.remove(world, body);\n        }, timeLeft);\n    }\n\n    return body;\n};\n\nexport const getEnergySourceData = (body: Matter.Body): EnergySourceData | undefined => {\n    if (energySources.has(body)) {\n        return energySources.get(body);\n    }\n    return undefined;\n};\n\nconst energySources = new WeakMap<Matter.Body, EnergySourceData>();\nconst linkedEnergySources: { [key: string]: Matter.Body } = {};\n","import Matter from 'matter-js';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { Body as GameKitBody, KeyListener, Sprite } from 'react-game-kit';\nimport { connect } from 'react-redux';\nimport UUID from 'uuid';\n\nimport { COLLISION_CATEGORY, COLLISION_GROUP } from '../../util/layer';\nimport { throttleExecution } from '../../util/limitRenders';\nimport { linkEnergySource } from '../energySources';\nimport { EnergySourceCreationData, energySources } from '../EnergySources/slice';\n\nexport interface Props {\n    x: number;\n    y: number;\n\n    addEnergySource: (x: EnergySourceCreationData) => void;\n}\n\nexport interface YoshiEggState {\n    x: number;\n    y: number;\n}\n\nclass YoshiEgg extends React.Component<Props, YoshiEggState> {\n    static contextTypes = {\n        engine: PropTypes.object,\n    };\n\n    constructor(props: Props) {\n        super(props);\n\n        this.state = { x: props.x, y: props.y };\n    }\n\n    componentDidMount() {\n        Matter.Events.on(this.context.engine, 'afterUpdate', this.update);\n    }\n\n    componentWillUnmount() {\n        Matter.Events.off(this.context.engine, 'afterUpdate', this.update);\n    }\n\n    update = throttleExecution(() => {\n        const bodyRef = this.bodyRef.current;\n\n        if (!bodyRef || !bodyRef.body) {\n            return;\n        }\n\n        const x = Math.round(10 * bodyRef.body.position.x) / 10;\n        const y = Math.round(10 * bodyRef.body.position.y) / 10;\n\n        if (this.state.x !== x || this.state.y !== y) {\n            this.setState({ x, y });\n        }\n\n        const casaLocX = 2600;\n        const casaLocY = 710;\n        const casaDistance = Math.sqrt((casaLocX - x) ** 2 + (casaLocY - y) ** 2);\n\n        if (casaDistance < 75 && this.spawnId === undefined) {\n            this.spawnId = UUID.v4();\n            linkEnergySource(this.spawnId, bodyRef.body);\n            this.props.addEnergySource({\n                id: this.spawnId,\n                x,\n                y,\n                radius: 50,\n                energyAmount: Number.POSITIVE_INFINITY,\n                lossDelta: 0,\n                colorCode: 'rgba(0, 255, 0, .7)',\n                playerGainEnergyDelta: () => 1.5,\n            });\n        }\n    });\n\n    getWrapperStyles(): React.CSSProperties {\n        const { x, y } = this.state;\n\n        return {\n            position: 'absolute',\n            left: x,\n            top: y,\n        };\n    }\n\n    render() {\n        const { x, y } = this.props;\n\n        return (\n            <div style={this.getWrapperStyles()}>\n                <GameKitBody\n                    shape=\"circle\"\n                    args={[x, y, 12]}\n                    inertia={Infinity}\n                    ref={this.bodyRef}\n                    collisionFilter={{\n                        group: COLLISION_GROUP.CAN_COLLIDE,\n                        category: COLLISION_CATEGORY.OBJECT,\n                        mask: COLLISION_CATEGORY.PLAYER | COLLISION_CATEGORY.WALL | COLLISION_CATEGORY.OBJECT,\n                    }}\n                >\n                    <img src=\"yoshiegg.png\" style={{ position: 'absolute', left: -13, top: -23 }} />\n                </GameKitBody>\n            </div>\n        );\n    }\n\n    private bodyRef = React.createRef<GameKitBody>();\n    private spawnId: string | undefined;\n}\n\nexport default connect(\n    undefined,\n    {\n        addEnergySource: energySources.actions.addEnergySource,\n    }\n)(YoshiEgg);\n","import { createSlice, PayloadAction } from 'redux-starter-kit';\n\nimport { worldItems } from '../WorldItems/slice';\nimport { WorldItem } from '../WorldItems/types';\nimport YoshiEgg from '../WorldItems/YoshiEgg';\nimport { InventoryItem } from './types';\n\nconst yoshiEgg: InventoryItem = {\n    name: 'Yoshi Egg',\n    onUse: ({ playerLocation }) =>\n        worldItems.actions.add({\n            Component: YoshiEgg,\n            props: { x: playerLocation.x + 30, y: playerLocation.y },\n        }),\n};\n\nexport const inventory = createSlice({\n    slice: 'inventory',\n    initialState: [yoshiEgg] as Array<InventoryItem>,\n    reducers: {\n        addItem: (state, { payload: item }: PayloadAction<InventoryItem>) => [...state, item],\n        removeItem: (state, { payload: index }: PayloadAction<number>) =>\n            state.slice(0, index - 1).concat(state.slice(index + 1)),\n    },\n});\n","import { createSlice, PayloadAction } from 'redux-starter-kit';\n\nimport { AvailableMenu, OpenMenu } from './types';\n\nexport const openMenus = createSlice({\n    slice: 'openMenus',\n    initialState: [] as Array<OpenMenu<AvailableMenu>>,\n    reducers: {\n        open: (state, { payload }: PayloadAction<OpenMenu<AvailableMenu>>) => [...state, payload],\n        closeTop: state => state.slice(0, -1),\n    },\n});\n","import { Omit } from 'react-redux';\nimport { combineReducers, configureStore, createSlice, PayloadAction } from 'redux-starter-kit';\nimport { EnhancedStore } from 'redux-starter-kit/src/configureStore';\n\nimport { EnergySourceData } from './game/energySources';\nimport { energySources } from './game/EnergySources/slice';\nimport { inventory } from './game/Inventory/slice';\nimport { InventoryItem } from './game/Inventory/types';\nimport { openMenus } from './game/Menu/slice';\nimport { AvailableMenu, MenuMeta, OpenMenu } from './game/Menu/types';\nimport { worldItems } from './game/WorldItems/slice';\n\nexport const playerStats = createSlice({\n    slice: 'playerStats',\n    initialState: {\n        energy: 100,\n        money: 30,\n        food: 42,\n    },\n    reducers: {\n        modifyEnergy: (state, { payload: energy }: PayloadAction<number>) => ({\n            ...state,\n            energy: Math.min(100, state.energy + energy),\n        }),\n        modifyMoney: (state, { payload: money }: PayloadAction<number>) => ({\n            ...state,\n            money: Math.max(0, state.money + money),\n        }),\n        modifyFood: (state, { payload: food }: PayloadAction<number>) => ({\n            ...state,\n            food: Math.max(0, state.food + food),\n        }),\n    },\n});\n\nexport const playerLocation = createSlice({\n    slice: 'playerLocation',\n    initialState: {\n        x: 2500,\n        y: 750,\n    },\n    reducers: {\n        setCharacterPosition: (state, { payload: { x, y } }: PayloadAction<{ x: number; y: number }>) => ({ x, y }),\n    },\n});\n\nexport const store = configureStore({\n    reducer: combineReducers({\n        playerStats: playerStats.reducer,\n        playerLocation: playerLocation.reducer,\n        energySources: energySources.reducer,\n        openMenus: openMenus.reducer,\n        inventory: inventory.reducer,\n        worldItems: worldItems.reducer,\n    }),\n    middleware: [],\n    devTools: true,\n    enhancers: [],\n});\n\nexport type State = typeof store extends EnhancedStore<infer State> ? State : never;\n","import Matter from 'matter-js';\nimport PropTypes from 'prop-types';\nimport * as React from 'react';\nimport { Body as GameKitBody, KeyListener, Sprite } from 'react-game-kit';\nimport { connect } from 'react-redux';\n\nimport { playerLocation, playerStats, State } from '../store';\nimport { COLLISION_CATEGORY, COLLISION_GROUP } from '../util/layer';\nimport { getFpsMeasure, throttleExecution } from '../util/limitRenders';\n\nexport interface Props {\n    keys: KeyListener;\n    x: number;\n    y: number;\n\n    energy: number;\n\n    setCharacterPosition: (_: { x: number; y: number }) => void;\n    modifyEnergy: (energy: number) => void;\n}\n\nexport interface CharacterState {\n    spriteState: number;\n    isMoving: boolean;\n}\n\nclass Character extends React.Component<Props, CharacterState> {\n    static contextTypes = {\n        engine: PropTypes.object,\n    };\n\n    constructor(props: Props) {\n        super(props);\n\n        this.state = {\n            spriteState: 0,\n            isMoving: false,\n        };\n    }\n    componentDidMount() {\n        Matter.Events.on(this.context.engine, 'afterUpdate', this.update);\n        this.modifyEnergyTimerId = window.setInterval(() => this.props.modifyEnergy(-0.125), 250);\n    }\n\n    componentWillUnmount() {\n        Matter.Events.off(this.context.engine, 'afterUpdate', this.update);\n\n        if (this.modifyEnergyTimerId) {\n            window.clearInterval(this.modifyEnergyTimerId);\n        }\n    }\n\n    move = (x: number, y: number) => {\n        const body = this.bodyRef.current;\n        if (body && body.body) {\n            Matter.Body.setVelocity(body.body, { x, y });\n            this.setState(state => {\n                const isMoving = x !== 0 || y !== 0;\n                return isMoving === state.isMoving ? null : { isMoving };\n            });\n        }\n    };\n\n    private fpsCounter = getFpsMeasure(fps => console.log('character updates this second', fps));\n    update = throttleExecution(() => {\n        this.fpsCounter();\n        const bodyRef = this.bodyRef.current;\n        this.checkKeys();\n\n        if (bodyRef && bodyRef.body) {\n            const pos = {\n                x: Math.round(1000 * bodyRef.body.position.x) / 1000,\n                y: Math.round(1000 * bodyRef.body.position.y) / 1000,\n            };\n\n            if (this.props.x !== pos.x || this.props.y !== pos.y) {\n                this.props.setCharacterPosition(pos);\n            }\n        }\n    });\n\n    checkKeys = () => {\n        const { energy, keys } = this.props;\n        const walkSpeed = energy < 15 ? 1 : energy < 25 ? 2 : 3.5;\n\n        let velocityX = 0;\n        let velocityY = 0;\n        let spriteState: number | undefined;\n\n        if (keys.isDown(keys.LEFT)) {\n            velocityX = -walkSpeed;\n            spriteState = 1;\n        }\n\n        if (keys.isDown(keys.RIGHT)) {\n            velocityX = walkSpeed;\n            spriteState = 2;\n        }\n\n        if (keys.isDown(keys.UP)) {\n            velocityY = -walkSpeed;\n            spriteState = 3;\n        }\n\n        if (keys.isDown(keys.DOWN)) {\n            velocityY = walkSpeed;\n            spriteState = 0;\n        }\n\n        if (spriteState !== undefined) {\n            this.setState({ spriteState });\n        }\n\n        if (velocityX !== 0 && velocityY !== 0) {\n            velocityX /= Math.sqrt(2);\n            velocityY /= Math.sqrt(2);\n        }\n\n        this.move(velocityX, velocityY);\n    };\n\n    getWrapperStyles(): React.CSSProperties {\n        const { x, y } = this.props;\n\n        return {\n            position: 'absolute',\n            left: x,\n            top: y,\n            width: 12,\n            height: 12,\n            transform: 'translateX(-6px) translateY(-6px)',\n        };\n    }\n\n    getSpriteWrapperStyle(): React.CSSProperties {\n        return {\n            transform: 'translateX(-2px) translateY(-12px)',\n        };\n    }\n\n    render() {\n        const { x, y } = this.props;\n\n        return (\n            <div style={this.getWrapperStyles()}>\n                <GameKitBody\n                    shape=\"circle\"\n                    args={[x, y, 6]}\n                    inertia={Infinity}\n                    ref={this.bodyRef}\n                    collisionFilter={{\n                        group: COLLISION_GROUP.CAN_COLLIDE,\n                        category: COLLISION_CATEGORY.PLAYER,\n                        mask: COLLISION_CATEGORY.ALL,\n                    }}\n                >\n                    <div style={this.getSpriteWrapperStyle()}>\n                        <Sprite\n                            tileHeight={24}\n                            tileWidth={16}\n                            key={this.state.isMoving.toString()}\n                            repeat={this.state.isMoving}\n                            src=\"tiles/kavi.png\"\n                            scale={1}\n                            state={this.state.spriteState}\n                            steps={[3, 3, 3, 3]}\n                        />\n                    </div>\n                </GameKitBody>\n            </div>\n        );\n    }\n\n    private bodyRef = React.createRef<GameKitBody>();\n    private modifyEnergyTimerId: number | undefined;\n}\n\nexport default connect(\n    ({ playerStats: { energy }, playerLocation: { x, y } }: State) => ({ energy, x, y }),\n    {\n        setCharacterPosition: playerLocation.actions.setCharacterPosition,\n        modifyEnergy: playerStats.actions.modifyEnergy,\n    }\n)(Character);\n","import Matter, { Render } from 'matter-js';\nimport PropTypes from 'prop-types';\nimport * as React from 'react';\nimport { KeyListener } from 'react-game-kit';\n\nimport { TmxJson, TsxJson } from '../util/layer';\nimport { throttleExecution } from '../util/limitRenders';\n\ntype Props = {\n    tmxJs: TmxJson;\n    tsxJs: TsxJson;\n    keys: KeyListener;\n};\n\ntype State = {\n    debugEnabled: boolean;\n    visibleLayers: string[];\n};\n\nexport class Debug extends React.Component<Props, State> {\n    static contextTypes = {\n        engine: PropTypes.object,\n    };\n    state = {\n        debugEnabled: false,\n        visibleLayers: ['collision01', 'collision02'],\n    };\n\n    componentDidMount() {\n        Matter.Events.on(this.context.engine, 'afterUpdate', this.checkKeys);\n    }\n\n    componentWillUnmount() {\n        Matter.Events.off(this.context.engine, 'afterUpdate', this.checkKeys);\n    }\n\n    checkKeys = throttleExecution(() => {\n        if (this.props.keys.isDown(80)) {\n            this.setState({ debugEnabled: true });\n        }\n    }, 10);\n\n    getWrapperStyles(): React.CSSProperties {\n        return {\n            position: 'absolute',\n            top: 0,\n            left: 0,\n        };\n    }\n\n    render() {\n        const {\n            tmxJs: { width, tilewidth, height, tileheight },\n        } = this.props;\n        const { debugEnabled } = this.state;\n\n        if (debugEnabled && this.canvas.current && !this.debugRender) {\n            this.debugRender = Render.create({\n                canvas: this.canvas.current!,\n                engine: this.context.engine,\n                options: {\n                    enabled: true,\n                    width: width * tilewidth,\n                    height: height * tileheight,\n                    pixelRatio: 0.5,\n                    background: false,\n                    wireframeBackground: false,\n                    wireframes: false,\n                    showSleeping: false,\n                    showDebug: false,\n                    showBroadphase: false,\n                    showBounds: false,\n                    showVelocity: true,\n                    showCollisions: true,\n                    showSeparations: false,\n                    showAxes: false,\n                    showPositions: false,\n                    showAngleIndicator: false,\n                    showIds: false,\n                    showShadows: false,\n                    showVertexNumbers: false,\n                    showConvexHulls: false,\n                    showInternalEdges: false,\n                    showMousePosition: false,\n                } as any,\n            });\n            Render.run(this.debugRender);\n        }\n\n        return (\n            <div style={{ ...this.getWrapperStyles() }}>\n                <canvas\n                    ref={this.canvas}\n                    style={{\n                        width: width * tilewidth,\n                        height: height * tileheight,\n                        position: 'absolute',\n                        top: 0,\n                        left: 0,\n                    }}\n                />\n            </div>\n        );\n    }\n\n    private canvas = React.createRef<HTMLCanvasElement>();\n    private debugRender?: Render;\n}\n","import Matter from 'matter-js';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport { EnergySourceData, getEnergySourceLink, registerEnergySource } from './energySources';\n\nexport interface EnergySourceState {\n    x: number;\n    y: number;\n}\n\nexport default class EnergySource extends React.Component<EnergySourceData, EnergySourceState> {\n    static contextTypes = {\n        engine: PropTypes.object,\n    };\n\n    private body: Matter.Body | undefined;\n    private linkTo: Matter.Body | undefined;\n\n    /*static getDerivedStateFromProps(props: EnergySourceData, state: EnergySourceState): EnergySourceState {\n        return this.linkTo ? state : props;\n    }*/\n\n    constructor(props: EnergySourceData) {\n        super(props);\n\n        this.state = { ...props };\n        this.linkTo = getEnergySourceLink(props.id);\n    }\n\n    componentDidMount() {\n        this.body = registerEnergySource(this.context.engine.world, this.props);\n\n        if (this.linkTo) {\n            Matter.Events.on(this.context.engine, 'afterUpdate', this.update);\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.body !== undefined) {\n            const { engine }: { engine: Matter.Engine } = this.context;\n            Matter.World.remove(engine.world, this.body);\n        }\n\n        Matter.Events.off(this.context.engine, 'afterUpdate', this.update);\n    }\n\n    update = () => {\n        if (this.linkTo === undefined || this.body === undefined) {\n            return;\n        }\n\n        const x = Math.round(10 * this.linkTo.position.x) / 10;\n        const y = Math.round(10 * this.linkTo.position.y) / 10;\n\n        if (this.state.x !== x || this.state.y !== y) {\n            this.setState({ x, y });\n            Matter.Body.setPosition(this.body, { x, y });\n            //this.body.position.x = x;\n            //this.body.position.y = y;\n        }\n    };\n\n    render() {\n        const { radius, colorCode } = this.props;\n\n        if (colorCode === null) {\n            return <div />;\n        }\n\n        return (\n            <svg\n                style={{\n                    position: 'absolute',\n                    left: this.state.x - radius * 2,\n                    top: this.state.y - radius * 2,\n                    width: 4 * radius,\n                    height: 4 * radius,\n                }}\n            >\n                <filter id=\"blurMe\">\n                    <feGaussianBlur in=\"SourceGraphic\" stdDeviation={radius * 0.06} />\n                </filter>\n\n                <circle cx={radius * 2} cy={radius * 2} r={radius} fill={colorCode} filter=\"url(#blurMe)\" />\n            </svg>\n        );\n    }\n}\n","import PropTypes from 'prop-types';\nimport * as React from 'react';\n\nimport { Layer, TmxJson, TsxJson } from '../util/layer';\n\ntype Props = {\n    tmxJs: TmxJson;\n    tsxJs: TsxJson;\n};\ntype State = {\n    tilemapLoaded: boolean;\n};\n\nexport class TiledMap extends React.Component<Props, State> {\n    state = { tilemapLoaded: false };\n    tilemapImage?: HTMLImageElement;\n\n    componentDidMount() {\n        if (!this.tilemapImage) {\n            this.setState({\n                tilemapLoaded: false,\n            });\n            const img = document.createElement('img');\n            img.src = this.tileFileName;\n            img.onload = () => this.setState({ tilemapLoaded: true });\n            this.tilemapImage = img;\n        }\n    }\n\n    async drawCanvas(tileSet: HTMLImageElement) {\n        const {\n            tmxJs: { layers },\n        } = this.props;\n\n        for (let l = 0; l < layers.length; l++) {\n            const layer = layers[l];\n            const canvas = this.canvasLayers[l].current;\n            const lastDrawnCanvas = this.lastDrawnCanvasLayers[l];\n            if (canvas && canvas !== lastDrawnCanvas) {\n                const ctx = canvas.getContext('2d');\n                if (!ctx) {\n                    return;\n                }\n                this.drawCanvasLayer(layer, ctx, tileSet);\n                this.lastDrawnCanvasLayers[l] = canvas;\n            }\n        }\n    }\n\n    drawCanvasLayer(layer: Layer, ctx: CanvasRenderingContext2D, tileSet: HTMLImageElement) {\n        const {\n            tmxJs: { width, height },\n        } = this.props;\n        if (layer.data) {\n            for (let y = 0; y < height; y++) {\n                for (let x = 0; x < width; x++) {\n                    const gridIndex = y * width + x;\n                    if (layer.data[gridIndex] === 0) {\n                        continue;\n                    }\n                    ctx.save();\n                    this.drawCanvasTile({ x, y }, layer.data[gridIndex], ctx, tileSet, layer);\n                    ctx.restore();\n                }\n            }\n        }\n        for (const subLayer of layer.layers || []) {\n            console.log('drawing Sublayer', subLayer);\n            this.drawCanvasLayer(subLayer, ctx, tileSet);\n        }\n    }\n\n    drawCanvasTile(\n        { x, y }: { x: number; y: number },\n        tileIndex: number,\n        ctx: CanvasRenderingContext2D,\n        tileset: HTMLImageElement,\n        layer: Layer\n    ) {\n        const {\n            tsxJs: { columns: cols, tileheight, tilewidth, spacing },\n        } = this.props;\n        const flip_horiz = 0x80000000 & tileIndex;\n        const flip_vert = 0x40000000 & tileIndex;\n        const flip_diag = 0x20000000 & tileIndex;\n        const realTileIndex = (tileIndex & 0x1fffffff) - 1;\n\n        const tileX = realTileIndex % cols;\n        const tileY = Math.floor(realTileIndex / cols);\n\n        const posX = x * tilewidth;\n        const posY = y * tileheight;\n\n        let left = (layer.x + tileX) * (tilewidth + spacing);\n        let top = (layer.y + tileY) * (tileheight + spacing);\n\n        ctx.translate(posX, posY);\n\n        if (flip_horiz) {\n            ctx.translate(tilewidth, 0);\n            ctx.scale(-1, 1);\n        }\n        if (flip_vert) {\n            ctx.translate(0, tileheight);\n            ctx.scale(1, -1);\n        }\n        if (flip_diag) {\n            ctx.rotate(Math.PI / 2);\n            ctx.scale(1, -1);\n        }\n\n        ctx.drawImage(tileset, left, top, tilewidth, tileheight, 0, 0, tilewidth, tileheight);\n    }\n\n    get tileFileName() {\n        return `tiles/${this.props.tsxJs.image}`;\n    }\n\n    getWrapperStyles(): React.CSSProperties {\n        return {\n            position: 'absolute',\n            top: 0,\n            left: 0,\n        };\n    }\n\n    render() {\n        const {\n            tmxJs: { layers, width, tilewidth, height, tileheight },\n        } = this.props;\n\n        if (this.tilemapImage && this.state.tilemapLoaded) {\n            this.drawCanvas(this.tilemapImage);\n        }\n\n        return (\n            <div style={{ ...this.getWrapperStyles() }}>\n                {layers.map((layer, idx) => (\n                    <canvas\n                        key={idx}\n                        ref={this.canvasLayers[idx]}\n                        width={width * tilewidth}\n                        height={height * tileheight}\n                        style={{\n                            width: width * tilewidth,\n                            height: height * tileheight,\n                            position: 'absolute',\n                            top: 0,\n                            left: 0,\n                        }}\n                    />\n                ))}\n            </div>\n        );\n    }\n\n    private canvasLayers = this.props.tmxJs.layers.map(() => React.createRef<HTMLCanvasElement>());\n    private lastDrawnCanvasLayers: HTMLCanvasElement[] = new Array(this.props.tmxJs.layers.length);\n}\n","import React, { Component } from 'react';\n\nimport { TileData } from '../util/layer';\nimport { TiledMap } from './TiledMap';\n\nexport default class Level extends Component<{ tileData: TileData }> {\n    render() {\n        return (\n            <div\n                style={{\n                    position: 'absolute',\n                    transform: `translate(${0}px, 0px) translateZ(0)`,\n                    transformOrigin: 'top left',\n                }}\n            >\n                <TiledMap {...this.props.tileData} />\n            </div>\n        );\n    }\n}\n","import Matter, { IPair } from 'matter-js';\nimport React, { Component } from 'react';\nimport { KeyListener, World } from 'react-game-kit';\nimport { connect } from 'react-redux';\n\nimport { playerStats, State } from '../store';\nimport { extractTmxCollisionComposite, TileData } from '../util/layer';\nimport { getFpsMeasure } from '../util/limitRenders';\nimport Character from './Character';\nimport { Debug } from './Debug';\nimport EnergySource from './EnergySource';\nimport { EnergySourceData, getEnergySourceData } from './energySources';\nimport { EnergySourceCreationData, energySources } from './EnergySources/slice';\nimport Level from './Level';\nimport YoshiEgg, { YoshiEggState } from './WorldItems/YoshiEgg';\n\nexport interface Props {\n    keyListener: KeyListener;\n    tileData: TileData;\n    energySources: Array<EnergySourceData>;\n\n    playerStats: State['playerStats'];\n    worldItems: State['worldItems'];\n\n    modifyEnergy: (energy: number) => void;\n    modifyMoney: (money: number) => void;\n    modifyFood: (food: number) => void;\n\n    addEnergySource: (x: EnergySourceCreationData) => void;\n}\n\nconst fpsCounter = getFpsMeasure(fps => console.log('engine frames this second', fps));\n\nclass IntroWorld extends Component<Props> {\n    constructor(props: Props) {\n        super(props);\n\n        const { tileheight, tilewidth, height, width } = props.tileData.tmxJs;\n        const [mapHeight, mapWidth] = [tileheight * height, tilewidth * width];\n\n        this.state = {\n            yoshiEggs: Array.from(Array(10)).map((_, i) => ({\n                x: Math.round(Math.random() * mapWidth),\n                y: Math.round(Math.random() * mapHeight),\n            })),\n        };\n    }\n\n    render() {\n        return (\n            <World onInit={this.physicsInit} onUpdate={fpsCounter}>\n                <Level tileData={this.props.tileData} />\n                <Debug {...this.props.tileData} keys={this.props.keyListener} />\n                {this.props.worldItems.map(({ Component, props }, key) => (\n                    <Component key={key} {...props} />\n                ))}\n                {this.props.energySources.map(x => (\n                    <EnergySource key={x.id} {...x} />\n                ))}\n                <Character keys={this.props.keyListener} />\n            </World>\n        );\n    }\n\n    public physicsInit = (engine: Matter.Engine) => {\n        engine.world.gravity.y = 0;\n        const collision = extractTmxCollisionComposite(this.props.tileData.tmxJs);\n        Matter.World.addComposite(engine.world, collision);\n\n        // der Arbeitsamt\n        this.props.addEnergySource({\n            x: 1175,\n            y: 630,\n            radius: 200,\n            energyAmount: Number.POSITIVE_INFINITY,\n            lossDelta: 0,\n            colorCode: 'rgba(255, 0, 0, .5)',\n            playerGainEnergyDelta: () => -2,\n            playerGainMoneyDelta: ({ money }) => (money < 100 ? 1.5 : 0),\n        });\n\n        // vong Häuslichkeit her, was für 1 Haus\n        this.props.addEnergySource({\n            x: 2600,\n            y: 710,\n            radius: 75,\n            energyAmount: Number.POSITIVE_INFINITY,\n            lossDelta: 0,\n            colorCode: 'rgba(0, 255, 0, .7)',\n            playerGainEnergyDelta: ({ food }) => (food > 0 ? 1 : -0.01),\n            playerGainFoodDelta: ({ energy }) => (energy < 90 ? -0.5 : -0.01),\n        });\n\n        // Marktstand: teuer, aber gutes Essen und wenig Stress (weil auf welchem Parkplatz ist schon stressig)\n        this.props.addEnergySource({\n            x: 1890,\n            y: 470,\n            radius: 25,\n            energyAmount: Number.POSITIVE_INFINITY,\n            lossDelta: 0,\n            colorCode: 'rgba(255, 255, 0, .7)',\n            playerGainEnergyDelta: () => -1,\n            playerGainMoneyDelta: () => -5,\n            playerGainFoodDelta: ({ money }) => (money ? 8 : 0),\n        });\n\n        // süper market\n        this.props.addEnergySource({\n            x: 2070,\n            y: 420,\n            radius: 40,\n            energyAmount: Number.POSITIVE_INFINITY,\n            lossDelta: 0,\n            colorCode: 'rgba(255, 255, 0, .7)',\n            playerGainEnergyDelta: () => -4,\n            playerGainMoneyDelta: () => -1,\n            playerGainFoodDelta: ({ money }) => (money ? 2 : 0),\n        });\n\n        // Hydrant auf der Straße\n        this.props.addEnergySource({\n            x: 2295,\n            y: 732,\n            radius: 25,\n            energyAmount: Number.POSITIVE_INFINITY,\n            lossDelta: 0,\n            colorCode: null,\n            playerGainEnergyDelta: ({ energy }) => (energy > 70 ? 0.25 : -0.1),\n        });\n\n        Matter.Events.on(engine, 'collisionActive', (e: any) => {\n            let totalDeltaEnergy = 0;\n            let totalDeltaMoney = 0;\n            let totalDeltaFood = 0;\n\n            for (const pair of (e.pairs || []) as Array<IPair>) {\n                const energySourceData = getEnergySourceData(pair.bodyA) || getEnergySourceData(pair.bodyB);\n                if (energySourceData === undefined) {\n                    continue;\n                }\n\n                const distance = Math.sqrt(\n                    (pair.bodyA.position.x - pair.bodyB.position.x) ** 2 +\n                        (pair.bodyA.position.y - pair.bodyB.position.y) ** 2\n                );\n\n                const factor = Math.max(0, energySourceData.radius - distance) / distance;\n                totalDeltaEnergy += energySourceData.playerGainEnergyDelta(this.props.playerStats) * factor;\n                totalDeltaMoney += energySourceData.playerGainMoneyDelta(this.props.playerStats) * factor;\n                totalDeltaFood += energySourceData.playerGainFoodDelta(this.props.playerStats) * factor;\n            }\n\n            if (totalDeltaEnergy !== 0) this.props.modifyEnergy(totalDeltaEnergy / 100);\n            if (totalDeltaMoney !== 0) this.props.modifyMoney(totalDeltaMoney / 100);\n            if (totalDeltaFood !== 0) this.props.modifyFood(totalDeltaFood / 100);\n        });\n    };\n}\n\nexport default connect(\n    ({ energySources, playerStats, worldItems }: State) => ({ energySources, playerStats, worldItems }),\n    {\n        modifyEnergy: playerStats.actions.modifyEnergy,\n        modifyMoney: playerStats.actions.modifyMoney,\n        modifyFood: playerStats.actions.modifyFood,\n\n        addEnergySource: energySources.actions.addEnergySource,\n    }\n)(IntroWorld);\n","import * as React from 'react';\n\nimport styled from '@emotion/styled';\n\nexport const MenuPane = styled.div({\n    border: 'solid red 1px',\n    width: '200px',\n    background: 'rgba(255,255,255,0.5)',\n    transform: 'scale(1.4)',\n    padding: '8px',\n});\n\nexport const MenuList = styled.div({\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n    width: '100%',\n    alignItems: 'stretch',\n    alignContent: 'center',\n});\n\ninterface MenuItemProps {\n    selected: boolean;\n}\nexport const MenuItem = styled.div<MenuItemProps>`\n    height: 16px;\n    background: ${props => (props.selected ? 'rgba(0,0,0,0.5)' : 'none')};\n`;\n","import PropTypes from 'prop-types';\nimport * as React from 'react';\n\nimport styled from '@emotion/styled-base';\n\nimport { throttleExecution } from '../../util/limitRenders';\nimport { KeyLock } from '../../util/LockableKeyListener';\nimport { PixelFont } from '../PixelFont';\nimport { MenuItem, MenuList, MenuPane } from './';\nimport { CommonMenuProps } from './types';\n\ninterface Props extends CommonMenuProps {\n    rows: Array<Row>;\n}\n\ninterface Row {\n    text: string;\n    onSelect?: () => void;\n    isEnabled?: () => boolean;\n}\n\ninterface State {\n    selectedOption: number;\n}\n\nclass BaseMenu extends React.Component<Props, State> {\n    static contextTypes = {\n        loop: PropTypes.object,\n    };\n    state = { selectedOption: 0 };\n    private keyLock?: KeyLock;\n    private loopSubscription?: number;\n\n    componentDidMount() {\n        this.keyLock = this.props.keyListener.acquireLock();\n        this.loopSubscription = this.context.loop.subscribe(this.checkKeys);\n    }\n\n    componentWillUnmount() {\n        this.context.loop.unsubscribe(this.loopSubscription!);\n        this.props.keyListener.releaseLock(this.keyLock!);\n    }\n\n    checkKeys = throttleExecution(() => {\n        const { keyListener } = this.props;\n\n        if (keyListener.isDown(keyListener.DOWN, this.keyLock)) this.changeSelectedOption(1);\n        if (keyListener.isDown(keyListener.UP, this.keyLock)) this.changeSelectedOption(-1);\n        if (keyListener.isDown(keyListener.SPACE, this.keyLock)) this.selectMenuOption();\n        if (keyListener.isDown(keyListener.ENTER, this.keyLock)) this.selectMenuOption();\n    }, 20);\n\n    changeSelectedOption = throttleExecution(\n        (movement: number) => this.setState(state => ({ ...state, selectedOption: state.selectedOption + movement })),\n        4\n    );\n\n    selectMenuOption = throttleExecution(() => {\n        const onSelect = this.props.rows.length > 0 && this.props.rows[this.selectedOption].onSelect;\n        if (onSelect) {\n            onSelect();\n        }\n    }, 1);\n\n    get selectedOption() {\n        return (this.state.selectedOption + this.props.rows.length) % this.props.rows.length;\n    }\n\n    render() {\n        const { style, className, rows } = this.props;\n        const { selectedOption } = this;\n        return (\n            <MenuPane style={style} className={className}>\n                <MenuList>\n                    {rows.map((row, idx) => (\n                        <MenuItem key={idx} onClick={row.onSelect} selected={selectedOption === idx}>\n                            <PixelFont text={row.text} style={{ display: 'block' }} />\n                        </MenuItem>\n                    ))}\n                </MenuList>\n            </MenuPane>\n        );\n    }\n}\n\nexport default styled(BaseMenu)`\n    position: absolute;\n    left: 400px;\n    top: 225px;\n    transform: translate(-50%, -50%);\n`;\n","import * as React from 'react';\nimport { connect } from 'react-redux';\nimport { Dispatch } from 'redux';\n\nimport { State } from '../../store';\nimport { inventory } from '../Inventory/slice';\nimport { InventoryItem } from '../Inventory/types';\nimport BaseMenu from './BaseMenu';\nimport { CommonMenuProps } from './types';\n\ninterface Props extends CommonMenuProps {\n    items: Array<InventoryItem>;\n    playerLocation: State['playerLocation'];\n    dispatch: Dispatch;\n}\nconst InventoryMenu = ({ items, playerLocation, dispatch, ...props }: Props) => (\n    <BaseMenu\n        rows={[\n            ...items.map((item, idx) => ({\n                text: item.name,\n                onSelect: () => {\n                    dispatch(inventory.actions.removeItem(idx));\n                    dispatch(item.onUse({ playerLocation }));\n                },\n            })),\n            { text: 'cancel', onSelect: props.closeTopMenu },\n        ]}\n        {...props}\n    />\n);\n\nexport default connect((state: State) => ({\n    items: state.inventory,\n    playerLocation: state.playerLocation,\n}))(InventoryMenu);\n","import * as React from 'react';\n\nimport BaseMenu from './BaseMenu';\nimport { CommonMenuProps } from './types';\n\nconst TestMenu = (props: CommonMenuProps) => (\n    <BaseMenu\n        {...props}\n        rows={[\n            { text: 'console.log(\"foo\")', onSelect: () => console.log('foo') },\n            { text: 'cancel', onSelect: props.closeTopMenu },\n        ]}\n    />\n);\n\nexport default TestMenu;\n","import PropTypes from 'prop-types';\nimport * as React from 'react';\nimport { connect } from 'react-redux';\nimport { PayloadActionCreator } from 'redux-starter-kit';\n\nimport { State } from '../../store';\nimport { throttleExecution } from '../../util/limitRenders';\nimport { LockableKeyListener } from '../../util/LockableKeyListener';\nimport InventoryMenu from './InventoryMenu';\nimport { openMenus } from './slice';\nimport TestMenu from './TestMenu';\nimport { AvailableMenu, CommonMenuProps, MenuComponentType, MenuMeta, OpenMenu } from './types';\n\ninterface Props {\n    menus: Array<OpenMenu<AvailableMenu>>;\n    keyListener: LockableKeyListener;\n    closeTopMenu: () => void;\n    openMenu: PayloadActionCreator<OpenMenu<AvailableMenu>>;\n}\n\nfunction getMenuComponent<T extends AvailableMenu>(menuName: T): MenuComponentType<T> {\n    switch (menuName as AvailableMenu) {\n        case 'TestMenu':\n            return TestMenu;\n        case 'InventoryMenu':\n            return InventoryMenu;\n    }\n}\nclass GameMenuHandler extends React.Component<Props> {\n    static contextTypes = {\n        loop: PropTypes.object,\n    };\n    private loopSubscription?: number;\n\n    componentDidMount() {\n        this.loopSubscription = this.context.loop.subscribe(this.checkKeys);\n    }\n\n    componentWillUnmount() {\n        this.context.loop.unsubscribe(this.loopSubscription!);\n    }\n\n    checkKeys = throttleExecution(() => {\n        const { keyListener } = this.props;\n\n        if (keyListener.isDown(keyListener.KEY_I)) this.openInventory();\n    }, 20);\n\n    openInventory = throttleExecution(() => this.props.openMenu({ menu: 'InventoryMenu' }), 4);\n\n    render() {\n        const { menus, keyListener, closeTopMenu, openMenu } = this.props;\n        const commonProps: CommonMenuProps = {\n            keyListener,\n            closeTopMenu,\n            openMenu,\n        };\n\n        return (\n            <>\n                {menus.map(({ menu, args }: { menu: AvailableMenu; args?: MenuMeta<any> }, idx) => {\n                    const Component = getMenuComponent(menu);\n                    return <Component key={idx} {...commonProps} args={args} />;\n                })}\n            </>\n        );\n    }\n}\n\nexport default connect(\n    (state: State) => ({ menus: state.openMenus }),\n    { closeTopMenu: openMenus.actions.closeTop, openMenu: openMenus.actions.open as any }\n)(GameMenuHandler);\n","import PropTypes from 'prop-types';\nimport React from 'react';\n\nexport default class Scalator extends React.Component {\n    static contextTypes = {\n        loop: PropTypes.object,\n        scale: PropTypes.number,\n    };\n\n    static childContextTypes = {\n        loop: PropTypes.object,\n        scale: PropTypes.number,\n    };\n\n    getChildContext() {\n        return {\n            scale: 1,\n            loop: this.context.loop,\n        };\n    }\n\n    getScaleStyles(): React.CSSProperties {\n        return {\n            transform: `scaleX(${this.context.scale}) scaleY(${this.context.scale})`,\n            transformOrigin: 'top left',\n        };\n    }\n\n    render() {\n        return <div style={this.getScaleStyles()}>{this.props.children}</div>;\n    }\n}\n","import React from 'react';\nimport { connect } from 'react-redux';\n\nimport { State as StoreState } from '../store';\n\nexport interface Props {\n    playerX: number;\n    playerY: number;\n\n    width: number;\n    height: number;\n}\n\nexport interface State {\n    left: number;\n    top: number;\n}\n\nclass Viewport extends React.Component<Props, State> {\n    static getDerivedStateFromProps(props: Props, state: State): State {\n        const displayX = props.playerX - state.left;\n        const displayY = props.playerY - state.top;\n\n        let newLeft = state.left;\n        let newTop = state.top;\n\n        if (displayX > props.width * 0.67) {\n            newLeft = props.playerX - props.width * 0.67;\n        }\n\n        if (displayY > props.height * 0.67) {\n            newTop = props.playerY - props.height * 0.67;\n        }\n\n        if (displayX < props.width * 0.33) {\n            newLeft = props.playerX - props.width * 0.33;\n        }\n\n        if (displayY < props.height * 0.33) {\n            newTop = props.playerY - props.height * 0.33;\n        }\n\n        return {\n            left: newLeft,\n            top: newTop,\n        };\n    }\n\n    constructor(props: Props) {\n        super(props);\n        this.state = {\n            left: 0,\n            top: 0,\n        };\n    }\n\n    resizeHandler = () => {\n        this.setState(state => Viewport.getDerivedStateFromProps(this.props, state));\n    };\n\n    componentDidMount() {\n        window.addEventListener('resize', this.resizeHandler);\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('resize', this.resizeHandler);\n    }\n\n    getStyles(): React.CSSProperties {\n        return {\n            transform: `translate(${-this.state.left}px, ${-this.state.top}px) `,\n            transformOrigin: 'top left',\n        };\n    }\n\n    render() {\n        return <div style={this.getStyles()}>{this.props.children}</div>;\n    }\n}\n\nexport default connect(({ playerLocation: { x, y } }: StoreState) => ({ playerX: x, playerY: y }))(Viewport);\n","import React, { Component } from 'react';\nimport { AudioPlayer, KeyListener, Loop, Stage } from 'react-game-kit';\nimport { connect } from 'react-redux';\n\nimport { State } from '../store';\nimport { TmxJson, TsxJson } from '../util/layer';\nimport { LockableKeyListener } from '../util/LockableKeyListener';\nimport GameStats from './GameStats';\nimport IntroWorld from './IntroWorld';\nimport GameMenuHandler from './Menu/GameMenuHandler';\nimport Scalator from './Scalator';\nimport Viewport from './Viewport';\n\nconst tmxJs: TmxJson = require('../assets/ClaimYourWorld.tmx.json');\nconst tsxJs: TsxJson = require('../assets/ClaimYourWorld.tsx.json');\n\nfunction makeDistortionCurve(amount: number | undefined) {\n    var k = typeof amount === 'number' ? amount : 50,\n        n_samples = 44100,\n        curve = new Float32Array(n_samples),\n        deg = Math.PI / 180,\n        i = 0,\n        x;\n    for (; i < n_samples; ++i) {\n        x = (i * 2) / n_samples - 1;\n        curve[i] = ((3 + k) * x * 20 * deg) / (Math.PI + k * Math.abs(x));\n    }\n    return curve;\n}\n\nexport interface Props {\n    energy: number;\n}\n\nclass Game extends Component<Props> {\n    private player: AudioPlayer | undefined;\n    private distortion: any;\n    private distortionLevel: any = null;\n    private stopMusic: undefined | (() => void);\n\n    public UNSAFE_componentWillReceiveProps(newProps: Props) {\n        if (newProps.energy <= 0) {\n            this.stopMusic && this.stopMusic();\n        } else if (newProps.energy < 15) {\n            if (this.distortionLevel !== 15) {\n                this.distortion.curve = makeDistortionCurve(60);\n                this.distortionLevel = 15;\n                console.log('moar destortion');\n            }\n        } else if (newProps.energy < 25) {\n            if (this.distortionLevel !== 25) {\n                this.distortion.curve = makeDistortionCurve(35);\n                this.distortionLevel = 25;\n                console.log('some distortion');\n            }\n        } else if (this.distortionLevel !== null) {\n            this.distortion.curve = null;\n            this.distortionLevel = null;\n        }\n    }\n\n    componentDidMount() {\n        this.player = new AudioPlayer('music/Depressed of Happytown.mp3', () => {\n            if (this.player === undefined) {\n                throw new Error('not reached');\n            }\n\n            const analyser = this.player.context.createAnalyser();\n            this.distortion = this.player.context.createWaveShaper();\n            const source = this.player.context.createBufferSource();\n\n            const gainNode = this.player.context.createGain();\n            gainNode.gain.value = 0.8;\n\n            source.connect(analyser);\n            analyser.connect(this.distortion);\n            this.distortion.connect(gainNode);\n            gainNode.connect(this.player.context.destination);\n\n            source.buffer = this.player.buffer;\n            source.start(0);\n            source.loop = true;\n            this.stopMusic = source.stop.bind(source);\n        });\n\n        this.keyListener.subscribe([\n            this.keyListener.LEFT,\n            this.keyListener.RIGHT,\n            this.keyListener.UP,\n            this.keyListener.DOWN,\n            this.keyListener.SPACE,\n            this.keyListener.ENTER,\n            this.keyListener.KEY_I,\n            this.keyListener.KEY_P,\n        ]);\n    }\n\n    componentWillUnmount() {\n        this.keyListener.unsubscribe();\n    }\n\n    isAlive = () => this.props.energy > 0;\n\n    render() {\n        if (!this.isAlive()) {\n            return <div style={{ background: 'red' }}>You lost the game.</div>;\n        }\n\n        return (\n            <Loop>\n                <Stage width={800} height={450} style={this.getStageStyles()}>\n                    <Scalator>\n                        <Viewport width={800} height={450}>\n                            <IntroWorld keyListener={this.keyListener} tileData={{ tmxJs, tsxJs }} />\n                        </Viewport>\n\n                        <div style={{ background: \"url('beams/BeamHeart_LightBrown_right.png')\" }} />\n                        <div className=\"game-stats-wrapper\" style={this.getGameStatsWrapperStyles()}>\n                            <GameStats />\n                        </div>\n                        <GameMenuHandler keyListener={this.keyListener} />\n                    </Scalator>\n                </Stage>\n            </Loop>\n        );\n    }\n\n    getStageStyles(): React.CSSProperties {\n        return {\n            background: '#3a9bdc',\n        };\n    }\n\n    getGameStatsWrapperStyles(): React.CSSProperties {\n        return {\n            position: 'absolute',\n            fontSize: '16pt',\n            left: 547,\n            top: 330,\n            width: 214,\n            height: 80,\n        };\n    }\n\n    private keyListener = new LockableKeyListener();\n}\n\nexport default connect(({ playerStats: { energy } }: State) => ({ energy }))(Game);\n","import Game from './Game';\n\nexport default Game;\n","import './index.css';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\n\nimport Game from './game';\nimport { store } from './store';\n\nReactDOM.render(\n    <Provider store={store}>\n        <Game />\n    </Provider>,\n    document.getElementById('root')\n);\n"],"sourceRoot":""}